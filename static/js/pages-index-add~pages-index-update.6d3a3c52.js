(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-index-add~pages-index-update"],{"144b":function(e,t,a){var i=a("24fb");t=i(!1),t.push([e.i,".view[data-v-b231ad58]{margin:1rem}.submit[data-v-b231ad58]{margin:2rem}.file-picker__box[data-v-b231ad58]{width:100px;height:100px}",""]),e.exports=t},"2b76":function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return r})),a.d(t,"a",(function(){return i}));var i={uniCard:a("884c").default,uniForms:a("71e4").default,uniFormsItem:a("aeba").default,uniEasyinput:a("17de").default,uniDataSelect:a("1e7f").default,uniFilePicker:a("9612").default,uniPopup:a("be18").default,uniPopupMessage:a("bd5d").default},n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",{staticClass:"view"},[a("uni-card",[["update"].includes(e.type)?a("v-uni-view",{staticStyle:{"font-size":"16px","font-weight":"bold","border-left":"3px solid blue"}},[e._v("编辑")]):a("v-uni-view",{staticStyle:{"font-size":"16px","font-weight":"bold","border-left":"3px solid blue"}},[e._v("新增")]),a("uni-forms",{attrs:{modelValue:e.form,"label-position":"left","label-width":"150px"}},[a("uni-forms-item",{attrs:{label:"商品名称:",name:"spuName"}},[a("uni-easyinput",{staticStyle:{width:"400rpx"},attrs:{type:"text",placeholder:"请输入商品名称"},model:{value:e.form.spuName,callback:function(t){e.$set(e.form,"spuName",t)},expression:"form.spuName"}})],1),a("uni-forms-item",{attrs:{label:"价格:",name:"price"}},[a("uni-easyinput",{staticStyle:{width:"400rpx"},attrs:{type:"text",placeholder:"请输入价格"},model:{value:e.form.price,callback:function(t){e.$set(e.form,"price",t)},expression:"form.price"}})],1),a("uni-forms-item",{attrs:{label:"描述:",name:"desc"}},[a("uni-easyinput",{staticStyle:{width:"400rpx"},attrs:{type:"text",placeholder:"请输入标题"},model:{value:e.form.desc,callback:function(t){e.$set(e.form,"desc",t)},expression:"form.desc"}})],1),a("uni-forms-item",{attrs:{label:"所属分类:",name:"type"}},[a("uni-data-select",{staticStyle:{width:"400rpx"},attrs:{localdata:e.spuAllTypeOptsMixins},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.changeType.apply(void 0,arguments)}},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}})],1),a("uni-forms-item",{attrs:{label:"是否选为天天特价:",name:"dailySpecial"}},[a("uni-data-select",{staticStyle:{width:"400rpx"},attrs:{localdata:e.yesOrNoOpts},model:{value:e.form.dailySpecial,callback:function(t){e.$set(e.form,"dailySpecial",t)},expression:"form.dailySpecial"}})],1),a("uni-forms-item",{attrs:{label:"是否选为每日推荐:",name:"dailyRecommend"}},[a("uni-data-select",{staticStyle:{width:"400rpx"},attrs:{localdata:e.yesOrNoOpts},model:{value:e.form.dailyRecommend,callback:function(t){e.$set(e.form,"dailyRecommend",t)},expression:"form.dailyRecommend"}})],1),a("uni-forms-item",{attrs:{label:"上传主页图:",name:"mainUrl"}},[a("uni-file-picker",{ref:"uploadMain",attrs:{fileMediatype:"image","del-icon":!1,"disable-preview":!0,limit:"1"},on:{select:function(t){arguments[0]=t=e.$handleEvent(t),e.selectMain.apply(void 0,arguments)}},model:{value:e.form.mainUrl,callback:function(t){e.$set(e.form,"mainUrl",t)},expression:"form.mainUrl"}})],1),a("uni-forms-item",{attrs:{label:"上传详情图:",name:"type"}},[a("uni-file-picker",{ref:"upload",attrs:{fileMediatype:"image",mode:"grid",limit:"9"},on:{select:function(t){arguments[0]=t=e.$handleEvent(t),e.select.apply(void 0,arguments)},progress:function(t){arguments[0]=t=e.$handleEvent(t),e.progress.apply(void 0,arguments)},success:function(t){arguments[0]=t=e.$handleEvent(t),e.success.apply(void 0,arguments)},delete:function(t){arguments[0]=t=e.$handleEvent(t),e.deletephoto.apply(void 0,arguments)},fail:function(t){arguments[0]=t=e.$handleEvent(t),e.fail.apply(void 0,arguments)}},model:{value:e.form.imgs,callback:function(t){e.$set(e.form,"imgs",t)},expression:"form.imgs"}})],1)],1),a("v-uni-view",{staticClass:"jump-next-area"},[a("v-uni-button",{staticClass:"jump-next submit",attrs:{size:"mini",type:"primary"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.addSub.apply(void 0,arguments)}}},[e._v("保存")]),a("v-uni-button",{staticClass:"jump-next submit",attrs:{size:"mini",type:"primary"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleBut.apply(void 0,arguments)}}},[e._v("取消")])],1),a("v-uni-view",[a("uni-popup",{ref:"message",attrs:{type:"message"}},[a("uni-popup-message",{attrs:{type:e.msgType,message:e.messageText,duration:2e3}})],1)],1)],1)],1)},r=[]},"53eb":function(e,t,a){var i=a("144b");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var n=a("4f06").default;n("59d7a29c",i,!0,{sourceMap:!1,shadowMode:!1})},"55b8":function(e,t,a){"use strict";var i=a("4ea4");a("c740"),a("caad"),a("d81d"),a("a434"),a("d3b7"),a("ac1f"),a("3ca3"),a("5319"),a("ddb0"),a("2b3d"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(a("2909"));a("96cf");var r=i(a("1da1")),o=a("9114"),l=a("19aa9"),s=i(a("af28")),c={mixins:[l.spuAllTypeMixins],props:["type"],data:function(){return{bwCoinCDNUrl:o.bwCoinImgcdnUrl,msgType:"success",messageText:"",URL:URL,title:"新增",form:{spuName:"",price:"",title:"",type:"",mainUrl:[],imgs:[]},yesOrNoOpts:[{text:"是",value:"YES"},{text:"否",value:"NO"}]}},mounted:function(){console.log("this.type",this.type),this.initspuAllTypeOptsMixins(),["update"].includes(this.type)&&this.getDetail()},onLoad:function(e){e.item&&(this.form=JSON.parse(decodeURIComponent(e.item)))},methods:{getUrl:function(e){if(console.log("blob",e),0!=e.length){var t=null,a=[];return a.push(e[0].file),t=window.URL.createObjectURL(new Blob(a,{type:"application/pdf;chartset=UTF-8"})),console.log("url",t),console.log("this.form.mainUrl",t,this.form.mainUrl),t}},getDetail:function(){var e=this;s.default.getDetailApi({code:this.$route.query.code}).then((function(t){console.log("res---",t),e.form=t,e.form.mainUrl=[{url:e.bwCoinCDNUrl+t.mainUrl}],console.log("this.form.mainUrl",e.form.mainUrl),e.form.imgs=t.imgs.map((function(t){return{fileID:t.id,id:t.id,url:e.bwCoinCDNUrl+t.imgUrl,imgUrl:t.imgUrl}})),console.log("this.form.imgs",e.form.imgs)}))},addSub:function(){var e=this;return(0,r.default)(regeneratorRuntime.mark((function t(){var a,i,n,l,c,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.form.imgs,i=e.form.mainUrl,t.next=4,(0,o.getAliOosClient)("bwcoin");case 4:if(n=t.sent,!i||!i[0].file){t.next=15;break}return l=i,console.log("file",l),t.next=10,n.put("spu-main-url-"+e.form.spuName.replace(/\s/g,"-")+"."+l[0].extname,l[0].file);case 10:c=t.sent,console.log("result",c),e.form.mainUrl=[c.name],t.next=16;break;case 15:e.form.mainUrl=e.form.mainUrl.map((function(e){var t=e.url.replace("https://bwcoin.oss-cn-beijing.aliyuncs.com/","");return console.log("img",t),t}));case 16:return console.log("this.form.mainUrl",e.form.mainUrl),t.next=19,Promise.all(a.map(function(){var t=(0,r.default)(regeneratorRuntime.mark((function t(i,r){var o,l,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!i.file){t.next=10;break}return o=i,console.log("file",o),t.next=5,n.put("spu-imgs-"+e.form.spuName.replace(/\s/g,"-")+r+"."+o.extname,o.file);case 5:l=t.sent,console.log("result",l),a[r]={id:0,imgUrl:l.name},t.next=12;break;case 10:s=a[r].url.replace("https://bwcoin.oss-cn-beijing.aliyuncs.com/",""),a[r]={id:a[r].fileID,imgUrl:s};case 12:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}()));case 19:console.log("imgs",a),u={spuName:e.form.spuName,price:e.form.price,desc:e.form.desc,type:e.form.type,dailySpecial:e.form.dailySpecial,dailyRecommend:e.form.dailyRecommend,imgs:e.form.imgs,mainUrl:e.form.mainUrl[0]},console.log("params",u),e.form.spuCode?(u.spuCode=e.form.spuCode,s.default.spuUpdateApi(u).then((function(e){uni.showToast({title:"编辑成功"}),setTimeout((function(){uni.navigateBack({delta:1})}),2e3)}))):(console.log("params",u),s.default.spuCreateApi(u).then((function(e){uni.showToast({title:"新增成功"}),setTimeout((function(){uni.navigateBack({delta:1})}),2e3)})));case 23:case"end":return t.stop()}}),t)})))()},addSub1:function(){var e=this;return(0,r.default)(regeneratorRuntime.mark((function t(){var a,i,n,r,l,s,c,u,d,f;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.form.spuCode){t.next=5;break}a={spuName:e.form.spuName,price:e.form.price,desc:e.form.desc,spuCode:e.form.spuCode},uni.request({url:"".concat(e.$baseUrl,"/spu/update"),method:"POST",data:a,success:function(e){uni.showToast({title:"编辑成功"}),setTimeout((function(){uni.navigateBack({delta:1})}),2e3)},fail:function(e){}}),t.next=39;break;case 5:i=e.form.imgs,console.log("list",i),n=0;case 8:if(!(n<i.length)){t.next=24;break}if(console.log("list[i]",i[n]),"object"!==typeof i[n]){t.next=21;break}return t.next=13,(0,o.getAliOosClient)("bwcoin");case 13:return r=t.sent,l=i[n],console.log("file",l),t.next=18,r.put("spu-imgs-"+e.form.spuName.replace(/\s/g,"-")+n+"."+l.extname,l.file);case 18:s=t.sent,console.log("result",s),i[n]={imgUrl:s.name};case 21:n++,t.next=8;break;case 24:if(console.log("typeof this.form.mainUrl",typeof e.form.mainUrl),"object"!==typeof e.form.mainUrl){t.next=36;break}return t.next=28,(0,o.getAliOosClient)("bwcoin");case 28:return c=t.sent,u=e.form.mainUrl,console.log("file",u),t.next=33,c.put("spu-main-url-"+e.form.spuName.replace(/\s/g,"-")+"."+u[0].extname,u[0].file);case 33:d=t.sent,console.log("result",d),e.form.mainUrl=[d.name];case 36:f={spuName:e.form.spuName,price:e.form.price,desc:e.form.desc,type:e.form.type,imgs:e.form.imgs,mainUrl:e.form.mainUrl[0]},console.log("params",f),uni.request({url:"".concat(e.$baseUrl,"/spu/create"),method:"POST",data:f,success:function(e){e&&(uni.showToast({title:"新增成功"}),setTimeout((function(){uni.navigateBack({delta:1},2e3)})))},fail:function(e){console.log("err",e)}});case 39:case"end":return t.stop()}}),t)})))()},validateFile:function(e){return!(e.size/1024/1024>.1)||(this.messageToggle("error"),!1)},selectMain:function(e){console.log("file",e),this.form.mainUrl=e.tempFiles},select:function(e){var t;console.log("选择文件：",e),(t=this.form.imgs).push.apply(t,(0,n.default)(e.tempFiles)),console.log("this.form.imgs",this.form.imgs)},deletephoto:function(e){console.log("e",e);var t=this.form.imgs.findIndex((function(t){e.tempFilePath,t.url}));this.form.imgs.splice(t,1),console.log("this.form.imgs",this.form.imgs)},progress:function(e){console.log("上传进度：",e)},success:function(e){console.log("上传成功",e)},fail:function(e){console.log("上传失败：",e)},changeType:function(e){console.log("e:-----",e)},handleBut:function(){console.log("===="),uni.navigateBack({delta:1})}}};t.default=c},"58cf":function(e,t,a){"use strict";a.r(t);var i=a("2b76"),n=a("d13c");for(var r in n)"default"!==r&&function(e){a.d(t,e,(function(){return n[e]}))}(r);a("962f");var o,l=a("f0c5"),s=Object(l["a"])(n["default"],i["b"],i["c"],!1,null,"b231ad58",null,!1,i["a"],o);t["default"]=s.exports},"604f":function(e,t,a){var i=a("24fb");t=i(!1),t.push([e.i,'@charset "UTF-8";\n/* 水平间距 */\n/* 水平间距 */.uni-card[data-v-44c0d81e]{margin:10px;padding:0 8px;border-radius:4px;overflow:hidden;font-family:Helvetica Neue,Helvetica,PingFang SC,Hiragino Sans GB,Microsoft YaHei,SimSun,sans-serif;background-color:#fff;flex:1}.uni-card .uni-card__cover[data-v-44c0d81e]{position:relative;margin-top:10px;flex-direction:row;overflow:hidden;border-radius:4px}.uni-card .uni-card__cover .uni-card__cover-image[data-v-44c0d81e]{flex:1;vertical-align:middle}.uni-card .uni-card__header[data-v-44c0d81e]{display:flex;border-bottom:1px #dcdcdc solid;flex-direction:row;align-items:center;padding:10px;overflow:hidden}.uni-card .uni-card__header .uni-card__header-box[data-v-44c0d81e]{display:flex;flex:1;flex-direction:row;align-items:center;overflow:hidden}.uni-card .uni-card__header .uni-card__header-avatar[data-v-44c0d81e]{width:40px;height:40px;overflow:hidden;border-radius:5px;margin-right:10px}.uni-card .uni-card__header .uni-card__header-avatar .uni-card__header-avatar-image[data-v-44c0d81e]{flex:1;width:40px;height:40px}.uni-card .uni-card__header .uni-card__header-content[data-v-44c0d81e]{display:flex;flex-direction:column;justify-content:center;flex:1;overflow:hidden}.uni-card .uni-card__header .uni-card__header-content .uni-card__header-content-title[data-v-44c0d81e]{font-size:15px;color:#3a3a3a}.uni-card .uni-card__header .uni-card__header-content .uni-card__header-content-subtitle[data-v-44c0d81e]{font-size:12px;margin-top:5px;color:#909399}.uni-card .uni-card__header .uni-card__header-extra[data-v-44c0d81e]{line-height:12px}.uni-card .uni-card__header .uni-card__header-extra .uni-card__header-extra-text[data-v-44c0d81e]{font-size:12px;color:#909399}.uni-card .uni-card__content[data-v-44c0d81e]{padding:10px;font-size:14px;color:#6a6a6a;line-height:22px}.uni-card .uni-card__actions[data-v-44c0d81e]{font-size:12px}.uni-card--border[data-v-44c0d81e]{border:1px solid #dcdcdc}.uni-card--shadow[data-v-44c0d81e]{position:relative;box-shadow:0 1px 8px 1px hsla(0,0%,64.7%,.2)}.uni-card--full[data-v-44c0d81e]{margin:0;border-left-width:0;border-left-width:0;border-radius:0}.uni-card--full[data-v-44c0d81e]:after{border-radius:0}.uni-ellipsis[data-v-44c0d81e]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}',""]),e.exports=t},"665c":function(e,t,a){"use strict";a.r(t);var i=a("fb88"),n=a.n(i);for(var r in i)"default"!==r&&function(e){a.d(t,e,(function(){return i[e]}))}(r);t["default"]=n.a},"884c":function(e,t,a){"use strict";a.r(t);var i=a("a0cd"),n=a("665c");for(var r in n)"default"!==r&&function(e){a.d(t,e,(function(){return n[e]}))}(r);a("fed8");var o,l=a("f0c5"),s=Object(l["a"])(n["default"],i["b"],i["c"],!1,null,"44c0d81e",null,!1,i["a"],o);t["default"]=s.exports},"962f":function(e,t,a){"use strict";var i=a("53eb"),n=a.n(i);n.a},a0cd:function(e,t,a){"use strict";var i;a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return r})),a.d(t,"a",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",{staticClass:"uni-card",class:{"uni-card--full":e.isFull,"uni-card--shadow":e.isShadow,"uni-card--border":e.border},style:{margin:e.isFull?0:e.margin,padding:e.spacing,"box-shadow":e.isShadow?e.shadow:""}},[e._t("cover",[e.cover?a("v-uni-view",{staticClass:"uni-card__cover"},[a("v-uni-image",{staticClass:"uni-card__cover-image",attrs:{mode:"widthFix",src:e.cover},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.onClick("cover")}}})],1):e._e()]),e._t("title",[e.title||e.extra?a("v-uni-view",{staticClass:"uni-card__header"},[a("v-uni-view",{staticClass:"uni-card__header-box",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.onClick("title")}}},[e.thumbnail?a("v-uni-view",{staticClass:"uni-card__header-avatar"},[a("v-uni-image",{staticClass:"uni-card__header-avatar-image",attrs:{src:e.thumbnail,mode:"aspectFit"}})],1):e._e(),a("v-uni-view",{staticClass:"uni-card__header-content"},[a("v-uni-text",{staticClass:"uni-card__header-content-title uni-ellipsis"},[e._v(e._s(e.title))]),e.title&&e.subTitle?a("v-uni-text",{staticClass:"uni-card__header-content-subtitle uni-ellipsis"},[e._v(e._s(e.subTitle))]):e._e()],1)],1),a("v-uni-view",{staticClass:"uni-card__header-extra",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.onClick("extra")}}},[a("v-uni-text",{staticClass:"uni-card__header-extra-text"},[e._v(e._s(e.extra))])],1)],1):e._e()]),a("v-uni-view",{staticClass:"uni-card__content",style:{padding:e.padding},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.onClick("content")}}},[e._t("default")],2),a("v-uni-view",{staticClass:"uni-card__actions",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.onClick("actions")}}},[e._t("actions")],2)],2)},r=[]},ac6a:function(e,t,a){var i=a("604f");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var n=a("4f06").default;n("194ad838",i,!0,{sourceMap:!1,shadowMode:!1})},d13c:function(e,t,a){"use strict";a.r(t);var i=a("55b8"),n=a.n(i);for(var r in i)"default"!==r&&function(e){a.d(t,e,(function(){return i[e]}))}(r);t["default"]=n.a},fb88:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={name:"UniCard",emits:["click"],props:{title:{type:String,default:""},subTitle:{type:String,default:""},padding:{type:String,default:"10px"},margin:{type:String,default:"15px"},spacing:{type:String,default:"0 10px"},extra:{type:String,default:""},cover:{type:String,default:""},thumbnail:{type:String,default:""},isFull:{type:Boolean,default:!1},isShadow:{type:Boolean,default:!0},shadow:{type:String,default:"0px 0px 3px 1px rgba(0, 0, 0, 0.08)"},border:{type:Boolean,default:!0}},methods:{onClick:function(e){this.$emit("click",e)}}};t.default=i},fed8:function(e,t,a){"use strict";var i=a("ac6a"),n=a.n(i);n.a}}]);